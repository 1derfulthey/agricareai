<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<meta name="description" content="AgriCare AI ‚Äî ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡πÅ‡∏°‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä‡∏î‡πâ‡∏ß‡∏¢ Teachable Machine" />
<title>AgriCare AI - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏¢‡∏Å‡πÅ‡∏°‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä</title>

<!-- Favicon -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üå±</text></svg>">

<!-- Performance hints -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="preconnect" href="https://teachablemachine.withgoogle.com" crossorigin>
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://teachablemachine.withgoogle.com">

<!-- Prefetch ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏° -->
<link rel="prefetch" href="https://teachablemachine.withgoogle.com/models/gCL-xqZ8C/model.json" as="fetch" crossorigin>
<link rel="prefetch" href="https://teachablemachine.withgoogle.com/models/gCL-xqZ8C/metadata.json" as="fetch" crossorigin>
<link rel="prefetch" href="https://teachablemachine.withgoogle.com/models/gCL-xqZ8C/weights.bin" as="fetch" crossorigin>

<!-- Fonts + Icons -->
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

<style>
:root{
  --primary:#2E7D32;--primary-dark:#1B5E20;--primary-light:#43A047;
  --accent:#8BC34A;--secondary:#FF9800;
  --bg:#F6FBF6;--surface:#fff;--ink:#1d1d1d;--ink-2:#596166;
  --outline:#E5EAE5;--error:#D32F2F;--ok:#2e7d32;
  --shadow:0 6px 18px rgba(0,0,0,.08);--shadow-sm:0 3px 10px rgba(0,0,0,.06);
  --r-sm:10px;--r-md:18px;--r-lg:26px;

  /* ‡∏õ‡∏∏‡πà‡∏° */
  --btn-radius:999px;
  --btn-elev:0 6px 18px rgba(46,125,50,.22);
  --btn-glow:0 0 0 0 rgba(76,175,80,.0);
  --btn-padding:14px 22px;

  /* ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞/‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û */
  --frame-inset:12px;
  --dash-w:3px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--ink);
  font-family:'Sarabun',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Kanit',sans-serif;
  line-height:1.7;
}

/* Header */
.header{
  position:sticky;top:0;z-index:20;
  background:linear-gradient(0deg,var(--primary-dark),var(--primary));
  color:#fff;box-shadow:var(--shadow);
}
.header-inner{max-width:1200px;margin:auto;display:flex;align-items:center;gap:16px;padding:14px 18px}
.brand{
  display:flex;align-items:center;gap:10px;font-weight:700;font-size:1.55rem;
  text-decoration:none;color:#fff;cursor:pointer;
}
.brand i{font-size:1.4em}

/* Top nav */
.nav{
  max-width:1200px;margin:10px auto 0;display:flex;gap:10px;justify-content:center;
  background:#e8f5e9;border-radius:999px;padding:8px 10px;box-shadow:var(--shadow-sm)
}
.nav a{
  display:inline-flex;align-items:center;gap:8px;padding:12px 22px;border-radius:999px;
  text-decoration:none;color:var(--primary-dark);font-weight:700;font-size:1.02rem;
  transition:.25s;white-space:nowrap
}
.nav a i{font-size:1.1rem}
.nav a.active, .nav a:hover{
  background:linear-gradient(135deg,var(--primary),var(--primary-light));
  color:#fff;transform:translateY(-1px)
}

/* Container */
.container{max-width:1200px;margin:18px auto;padding:0 16px}

/* ---------- Steps: line + dots + icons ---------- */
.steps{
  position:relative;
  max-width:1000px;
  margin:0 auto 16px;
  padding:24px 6px 4px;
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
}
.steps-line{position:absolute; height:4px; background:#dfe8df; border-radius:999px; top:28px; left:12px; right:12px}
.steps-fill{position:absolute; height:4px; background:#a7d3a8; border-radius:999px; top:28px; left:12px; width:0}
.step{ position:relative; display:flex; flex-direction:column; align-items:center; gap:8px; font-weight:700; color:#42534d; background:none; border:none; box-shadow:none; padding:0; flex:1 1 0; text-align:center }
.step .dot{ width:14px;height:14px;border-radius:50%; background:#cfd9cf;border:3px solid #fff;z-index:1;box-shadow:0 0 0 3px #e9f6ea }
.step .lbl{ display:inline-flex; align-items:center; gap:8px; font-size:.95rem; background:#f6fbf6; padding:2px 8px; border-radius:8px }
.step .lbl i{ color:#2E7D32 }
.step.active .dot{background:#43A047}
.step.done .dot{background:#2E7D32}

/* Hero */
.hero{
  background:var(--surface);border-radius:var(--r-lg);box-shadow:var(--shadow);
  padding:28px 18px 32px;border:1px solid var(--outline);
}
.hero h1{
  font-family:'Kanit',sans-serif;color:var(--primary-dark);
  text-align:center;font-size:2.4rem;margin:.3rem 0 10px
}
.hero p{color:var(--ink-2);text-align:center;margin:0 0 24px}

/* Grid */
.grid{
  display:flex;flex-wrap:wrap;gap:18px;
  justify-content:center; align-items:stretch;
  max-width:1000px; margin-inline:auto;
}
.card{
  background:var(--surface);border:1px solid var(--outline);border-radius:18px;
  box-shadow:var(--shadow-sm);padding:22px 16px;text-align:center;cursor:pointer;
  transition:.25s;min-height:160px;display:flex;flex-direction:column;align-items:center;justify-content:center;
  width:100%;max-width:320px; flex:0 1 260px;
}
.card:hover{transform:translateY(-4px);box-shadow:var(--shadow)}
.card i{font-size:2.2rem;margin-bottom:10px}
.card h3{margin:0;font-family:'Kanit',sans-serif}

/* Sections */
.page-section{display:none;animation:fade .35s ease}
.page-section.active{display:block}
@keyframes fade{from{opacity:0;translate:0 8px}to{opacity:1;translate:0 0}}

/* Titles & panels */
.section-title{display:flex;align-items:center;gap:10px;color:var(--primary-dark)}
.section-title i{background:#e9f6ea;width:44px;height:44px;border-radius:50%;display:grid;place-items:center;font-size:1.2rem}
.panel{background:var(--surface);border:1px solid var(--outline);border-radius:var(--r-lg);box-shadow:var(--shadow);padding:20px}

/* ====== Image box ====== */
.image-box{
  width:100%; max-width:720px; height:430px; margin:auto; position:relative;
  padding: calc(var(--frame-inset) + var(--dash-w));
  border-radius:22px; background:linear-gradient(180deg,#ffffff,#fbfdfb);
  display:flex;align-items:center;justify-content:center; overflow:hidden;
  box-shadow:0 12px 24px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.7);
}
.image-box::before{content:""; position:absolute; inset:0; border:4px dashed #b8d9b9; border-radius:22px; pointer-events:none}
.image-box::after{content:""; position:absolute; inset:var(--frame-inset); border:var(--dash-w) dashed #c9e4c8; border-radius:18px; pointer-events:none}
.image-box video,.image-box img{width:100%; height:100%; object-fit:cover; border-radius:14px; z-index:1; transition:transform .15s ease-out; display:block}
.placeholder{ position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;color:#9aa7a1; z-index:2 }
.placeholder i{font-size:3.2rem;margin-bottom:10px}

/* Source chip */
.img-chip{ position:absolute;left:12px;top:12px;z-index:3; background:#1b5e20;color:#fff;border-radius:999px;padding:6px 10px;font-weight:800;font-size:.9rem;box-shadow:var(--shadow-sm) }

/* Zoom control */
.zoom-wrap{
  position:absolute; right:12px; bottom:12px; z-index:3;
  display:none; align-items:center; gap:8px;
  background:#ffffffd9; border:1px solid #dfe9df; border-radius:999px; padding:6px 10px;
  box-shadow:var(--shadow-sm); color:#1b5e20;
}
.zoom-wrap input[type="range"]{ width:140px }
.zoom-wrap .zbtn{ background:#e9f6ea; border:none; border-radius:50%; width:28px; height:28px; display:grid; place-items:center; cursor:pointer; color:#1b5e20 }
.zoom-level{ font-weight:800; min-width:38px; text-align:center }

/* ================= Buttons (‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ô‡πâ‡∏ô CTA) ================= */
.actions{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;margin-top:18px}
.btn{
  --bg:var(--primary);--bg2:#3aa446;
  position:relative; overflow:hidden;
  background:linear-gradient(135deg,var(--bg),var(--bg2));
  color:#fff;border:none;border-radius:var(--btn-radius);
  padding:var(--btn-padding);font-weight:800;letter-spacing:.2px;
  font-size:1.05rem;display:inline-flex;gap:10px;align-items:center;justify-content:center;
  cursor:pointer; box-shadow:var(--btn-elev);
  transition:transform .15s ease, box-shadow .2s ease, filter .2s ease;
  min-width:184px;
}
.btn i{font-size:1.05rem}
.btn:hover{transform:translateY(-2px); filter:saturate(1.05)}
.btn:active{transform:translateY(-1px) scale(.985)}
.btn[disabled]{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none}

/* ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏° */
.btn.secondary{--bg:#FF9800;--bg2:#FFB74D}
.btn.info{--bg:#1E88E5;--bg2:#4FC3F7}
.btn.danger{--bg:#e53935;--bg2:#ef5350}
.btn.gray{--bg:#90A4AE;--bg2:#B0BEC5}

/* Loading spinner (‡πÄ‡∏î‡∏¥‡∏°) */
.btn.loading{padding-left:42px;pointer-events:none}
.btn.loading::before{
  content:"";position:absolute;left:16px;top:50%;transform:translateY(-50%);
  width:16px;height:16px;border:3px solid rgba(255,255,255,.5);border-top-color:#fff;border-radius:50%;
  animation:rot .9s linear infinite;
}

/* Ripple effect (‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏µ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏ô‡∏∏‡πà‡∏° ‡πÜ) */
.btn::after{
  content:""; position:absolute; left:var(--ripple-x,50%); top:var(--ripple-y,50%);
  transform:translate(-50%,-50%) scale(0);
  width:10px;height:10px;border-radius:50%; background:rgba(255,255,255,.55);
  pointer-events:none; opacity:0; transition:transform .6s ease, opacity .8s ease;
}
.btn.rippling::after{ transform:translate(-50%,-50%) scale(22); opacity:0 }

/* Focus-visible ring (‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î) */
.btn:focus-visible{ outline:none; box-shadow:0 0 0 4px rgba(76,175,80,.24), 0 0 0 2px #fff inset }

/* Pulse ‡∏î‡∏∂‡∏á‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ (‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà‡∏ï‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å) */
@keyframes pulseOnce{
  0%{ transform:translateY(0) scale(1); box-shadow:var(--btn-elev) }
  40%{ transform:translateY(-2px) scale(1.03); box-shadow:0 10px 28px rgba(46,125,50,.35) }
  100%{ transform:translateY(0) scale(1); box-shadow:var(--btn-elev) }
}
.btn.pulse-once{ animation:pulseOnce .9s ease-out 1 }

/* Sticky action bar */
.analysis-bar{
  position:sticky;bottom:-8px;
  background:rgba(255,255,255,.9);
  backdrop-filter:saturate(1.2) blur(6px);
  border:1px solid var(--outline);
  border-radius:16px;
  padding:10px;
  box-shadow:var(--shadow-sm);
}

/* Loading (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ) */
.loading{display:none;align-items:center;gap:10px;justify-content:center;margin:14px 0;color:var(--ink-2)}
.loading .spin{ width:28px;height:28px;border:4px solid #e8f1e8;border-top-color:var(--primary);border-radius:50%; animation:rot .9s linear infinite }
@keyframes rot{to{transform:rotate(360deg)}}

/* Result */
.result-grid{display:grid;grid-template-columns:1.05fr 1.6fr;gap:24px}
.result-img{ background:linear-gradient(135deg,#f3faf3,#eaf5ea); border-radius:22px;padding:14px;border:1px solid #dfe9df; box-shadow:0 10px 24px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.6) }
.result-img .frame{
  position:relative; border-radius:18px;overflow:hidden;background:#fff;
  aspect-ratio: 4/3; display:flex;align-items:center;justify-content:center;
  box-shadow:inset 0 0 0 1px rgba(0,0,0,.03);
  padding: calc(var(--frame-inset) + var(--dash-w));
}
.result-img .frame::after{content:"";position:absolute;inset:var(--frame-inset); border:var(--dash-w) dashed #c9dfc9;border-radius:14px;pointer-events:none}
.result-img img{width:100%;height:100%;object-fit:cover;display:block;border-radius:14px}

.tip-card{ margin-top:14px;background:#F4FAF3;border:1px solid #d6ead6;border-radius:16px; padding:14px 16px;box-shadow:var(--shadow-sm) }
.tip-title{display:flex;align-items:center;gap:10px;color:#1b5e20;font-weight:800;margin:0 0 6px}
.tip-title i{color:#2E7D32}
.tip-list{list-style:none;padding:0;margin:8px 0 0}
.tip-list li{display:flex;gap:10px;align-items:flex-start;margin:8px 0;color:#42534d}
.tip-list li i{color:#43A047;margin-top:2px}

/* badges */
.badge{display:inline-flex;align-items:center;gap:8px;background:#ffeaea;color:#b71c1c;padding:8px 12px;border-radius:999px;font-weight:700;margin-bottom:8px}
.badge.beneficial{background:#e8f5e9;color:#1b5e20}
.badge.healthy{background:#e8f5e9;color:#1b5e20}
.badge.disease{background:#fff3e0;color:#e65100}
.badge.unknown{background:#fff8e1;color:#8d6e00}

/* result title + confidence */
.result-title{font-family:'Kanit',sans-serif;font-size:2rem;margin:.4rem 0 .6rem}
.conf-row{display:flex;align-items:center;gap:10px;margin:10px 0 6px}
.conf-row i{color:#2e7d32}
.conf-label{font-weight:800;letter-spacing:.2px;padding:4px 10px;border-radius:10px;background:#e9f6ea;color:#1b5e20;display:inline-flex;align-items:center;gap:8px}
.conf-bubble{background:#1b5e20;color:#fff;border-radius:999px;padding:6px 10px;font-weight:800;min-width:64px;text-align:center}

/* confidence meter */
.meter{position:relative;height:18px;border-radius:999px;background:#e8efe8;overflow:hidden;box-shadow:inset 0 1px 2px rgba(0,0,0,.08)}
.meter > span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#a5d6a7,#66bb6a,#43a047);transition:width .9s cubic-bezier(.22,.61,.36,1)}

/* blocks */
.block h4{display:flex;align-items:center;gap:10px;margin:18px 0 10px;color:var(--primary-dark)}
.block h4 i{color:var(--primary)}
.list{list-style:none;padding:0;margin:0}
.list li{display:flex;align-items:center;gap:10px;margin:8px 0}
.list li i{color:#2e7d32}
.near li i{color:#7cb342}
.near li{margin:6px 0}

/* Unknown box */
.unknown-box{background:#fff7e6;border:1px solid #ffe0b2;padding:16px;border-radius:14px;margin-top:14px;color:#6d4c41}

/* disclaimer */
.disclaimer{background:#FFF8E6;border:1px solid #F3D38C;color:#6D4C41;padding:12px;border-radius:12px;margin-top:12px;display:flex;gap:10px;align-items:flex-start}

/* Footer */
footer{max-width:1200px;margin:24px auto;padding:16px;color:#62706b;text-align:center}

/* Forms */
.form{max-width:640px;margin:auto}
.form .group{margin:14px 0}
.form label{font-weight:700;margin-bottom:6px;display:block}
.form input,.form select,.form textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--outline);background:#fafdf9;font-size:1rem}
.form textarea{min-height:110px;resize:vertical}

/* Upload progress */
.upload-progress{margin:8px 0 0 0;display:none}
.upload-progress .bar{height:10px;border-radius:999px;background:#e8efe8;overflow:hidden}
.upload-progress .bar span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#a5d6a7,#66bb6a,#43a047);transition:width .3s ease}
.upload-progress .txt{font-size:.92rem;color:#42534d;margin-top:6px;text-align:center}

/* Modals */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:50}
.modal .box{background:#fff;border-radius:18px;box-shadow:var(--shadow);max-width:460px;width:92%;padding:20px 22px;text-align:center}
.modal .box h3{margin:8px 0 6px;font-family:'Kanit',sans-serif;color:#1b5e20}
.modal .box p{margin:0 0 12px;color:#54635c}
.modal .box .ok{margin-top:6px}

/* Toast */
.toast{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:10px;z-index:60}
.toast-item{background:#1b5e20;color:#fff;padding:10px 14px;border-radius:12px;box-shadow:var(--shadow-sm);font-weight:700;min-width:240px;max-width:320px}
.toast-item.info{background:#1565c0}
.toast-item.error{background:#c62828}
.toast-item.success{background:#2e7d32}

/* ===== Overlay: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î ===== */
.busy-overlay{position:fixed;inset:0;background:rgba(0,0,0,.38);display:none;align-items:center;justify-content:center;z-index:80}
.busy-box{background:#fff;border:1px solid var(--outline);border-radius:18px;box-shadow:var(--shadow);padding:20px 22px;width:92%;max-width:420px;text-align:center}
.busy-title{font-family:'Kanit',sans-serif;color:#1b5e20;font-size:1.2rem;margin:0 0 4px}
.ring-wrap{position:relative;width:96px;height:96px;margin:8px auto 12px}
.progress-ring{position:absolute;inset:0;border-radius:50%;background:conic-gradient(#43A047 calc(var(--pct,0)*1%), #e8efe8 0)}
.progress-ring::after{content:"";position:absolute;inset:8px;border-radius:50%;background:#fff}
.progress-center{position:absolute;inset:0;display:grid;place-items:center;font-weight:800;color:#1b5e20}
.busy-text{color:#4f6059;margin:6px 0 6px}
.busy-loading{display:flex;align-items:center;gap:10px;justify-content:center;color:#4f6059}

/* ===== Global floating Back button ===== */
.back-fab{
  position:fixed; left:16px; bottom:calc(16px + env(safe-area-inset-bottom, 0));
  z-index:70; display:none;
  box-shadow:var(--shadow); padding:12px 18px; border-radius:999px;
}
.back-fab i{font-size:1rem}

/* A11y helper */
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* Responsive */
@media (max-width:1000px){ .result-grid{grid-template-columns:1fr} }
@media (max-width:640px){
  .brand{font-size:1.3rem}
  .nav{flex-wrap:wrap}
  .nav a{font-size:1rem;padding:12px 18px}
  .hero h1{font-size:2rem}
  .image-box{height:360px}
  .btn{min-width:46%;padding:14px 16px}
  .card{flex:0 1 calc(50% - 18px);max-width:300px;min-height:140px}
}
</style>
</head>
<body>

<header class="header">
  <div class="header-inner">
    <a href="#" class="brand" id="logo"><i class="fa-solid fa-seedling"></i> AgriCare AI</a>
  </div>
</header>

<nav class="nav" id="top-nav" style="display:none">
  <a href="#" data-target="home-page" class="active"><i class="fa-solid fa-house"></i>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
  <a href="#" data-target="analysis-page"><i class="fa-solid fa-magnifying-glass"></i>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</a>
  <a href="#" data-target="result-page"><i class="fa-solid fa-chart-pie"></i>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</a>
  <a href="#" data-target="report-feedback-page"><i class="fa-solid fa-heart"></i>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</a>
</nav>

<main class="container">

  <!-- Steps -->
  <div id="steps" class="steps" style="display:none">
    <div class="steps-line" id="steps-line"></div>
    <div class="steps-fill" id="steps-fill"></div>

    <div class="step" data-step="home"><span class="dot"></span><span class="lbl"><i class="fa-solid fa-shapes"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î</span></div>
    <div class="step" data-step="analysis"><span class="dot"></span><span class="lbl"><i class="fa-solid fa-magnifying-glass"></i>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</span></div>
    <div class="step" data-step="result"><span class="dot"></span><span class="lbl"><i class="fa-solid fa-chart-pie"></i>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</span></div>
    <div class="step" data-step="report"><span class="dot"></span><span class="lbl"><i class="fa-solid fa-heart"></i>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</span></div>
  </div>

  <!-- HOME -->
  <section id="home-page" class="page-section active">
    <div class="hero">
      <h1>‡∏î‡∏ß‡∏á‡∏ï‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£</h1>
      <p>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡∏•‡∏á‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ AI ‚Äî ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</p>
      <div class="grid">
        <a class="card feature" data-model="insect"><i class="fa-solid fa-bug" style="color:#d6741e"></i><h3>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏°‡∏•‡∏á</h3></a>
        <a class="card feature" data-model="corn"><i class="fa-solid fa-seedling" style="color:#f3b300"></i><h3>‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î</h3></a>
        <a class="card feature" data-model="sugarcane"><i class="fa-solid fa-leaf" style="color:#7CB342"></i><h3>‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢</h3></a>
        <a class="card feature" data-model="cassava"><i class="fa-solid fa-wheat-awn" style="color:#6D4C41"></i><h3>‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á</h3></a>
        <a class="card" id="contribute-data-home"><i class="fa-solid fa-robot" style="color:#0ea5e9"></i><h3>‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI</h3></a>
        <a class="card" id="usage-btn"><i class="fa-solid fa-circle-question" style="color:#3F51B5"></i><h3>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3></a>
        <a class="card" id="about-btn"><i class="fa-solid fa-circle-info" style="color:#8E24AA"></i><h3>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h3></a>
      </div>
      <div class="panel" style="margin-top:18px;text-align:center;color:#2e7d32">
        ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô : ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äò‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‚Äô ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      </div>
    </div>
  </section>

  <!-- ANALYSIS -->
  <section id="analysis-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-camera-retro"></i> <span id="analysis-title">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</span></h2>
    <div class="panel">
      <div class="image-box" id="image-box">
        <div id="img-source" class="img-chip" style="display:none">‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á</div>

        <!-- Zoom control -->
        <div id="zoom-wrap" class="zoom-wrap" aria-label="‡∏ã‡∏π‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á">
          <button class="zbtn" id="zoom-out" title="‡∏ã‡∏π‡∏°‡∏≠‡∏≠‡∏Å"><i class="fa-solid fa-minus"></i></button>
          <input type="range" id="zoom-range" min="1" max="3" step="0.1" value="1" />
          <button class="zbtn" id="zoom-in" title="‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤"><i class="fa-solid fa-plus"></i></button>
          <span class="zoom-level" id="zoom-level">1.0√ó</span>
        </div>

        <div class="placeholder" id="placeholder"><i class="fa-regular fa-image"></i><div id="instruction">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</div></div>
        <video id="webcam" autoplay playsinline style="display:none"></video>
        <img id="preview" alt="" style="display:none" />
      </div>

      <div class="loading" id="loading"><div class="spin"></div><span id="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•/‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‚Ä¶</span></div>

      <div class="actions analysis-bar" aria-label="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå">
        <button class="btn" id="capture" title="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û"><i class="fa-solid fa-camera"></i>‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
        <button class="btn secondary" id="upload" title="‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á"><i class="fa-solid fa-upload"></i>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</button>
        <input type="file" id="file-input" accept="image/*" hidden>
        <button class="btn info" id="analyze" title="‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ" style="display:none" disabled>
          <i class="fa-solid fa-magnifying-glass-chart"></i>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û
        </button>
        <button class="btn gray" id="recapture" style="display:none"><i class="fa-solid fa-arrows-rotate"></i>‡∏ñ‡πà‡∏≤‡∏¢/‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà</button>
      </div>
      <div id="sr-status" class="sr-only" aria-live="polite"></div>
    </div>
  </section>

  <!-- RESULT -->
  <section id="result-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-chart-pie"></i> ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h2>
    <div class="panel">
      <div class="result-grid">
        <div>
          <div class="result-img">
            <div class="frame">
              <img id="result-image" alt="‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå" decoding="async">
            </div>
          </div>

          <div class="tip-card">
            <div class="tip-title"><i class="fa-solid fa-lightbulb"></i>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</div>
            <ul class="tip-list">
              <li><i class="fa-solid fa-check-circle"></i><span>‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ä‡∏±‡∏î ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏î‡∏µ ‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á‡∏¢‡πâ‡∏≠‡∏ô</span></li>
              <li><i class="fa-solid fa-check-circle"></i><span>‡∏Å‡∏£‡∏ì‡∏µ‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä ‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏Å‡∏•‡πâ‡∏à‡∏∏‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö/‡∏Å‡∏¥‡πà‡∏á</span></li>
              <li><i class="fa-solid fa-check-circle"></i><span>‡∏ñ‡πâ‡∏≤‡∏ú‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡∏Å‡∏î <b>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</b></span></li>
              <li><i class="fa-solid fa-check-circle"></i><span>‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏∏‡∏°‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô</span></li>
            </ul>
          </div>
        </div>

        <div>
          <span id="result-type" class="badge unknown"><i class="fa-solid fa-tag"></i><b>‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</b></span>
          <div class="result-title" id="result-name">‚Äî</div>

          <div class="conf-row">
            <span class="conf-label"><i class="fa-solid fa-chart-line"></i> ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à</span>
            <span id="conf-bubble" class="conf-bubble">‚Äî</span>
          </div>
          <div class="meter" aria-label="confidence meter"><span id="conf-fill"></span></div>

          <div class="block" id="result-info" style="margin-top:8px"></div>

          <div id="result-disclaimer"></div>

          <div class="block" id="nearby-block" style="margin-top:10px">
            <h4><i class="fa-solid fa-list-check"></i>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á</h4>
            <ul class="list near" id="nearby-list"></ul>
          </div>

          <div class="actions" style="margin-top:16px">
            <button class="btn" id="go-report"><i class="fa-solid fa-heart"></i>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</button>
            <button class="btn danger" id="again"><i class="fa-solid fa-magnifying-glass"></i>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- REPORT -->
  <section id="report-feedback-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-heart"></i> ‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</h2>
    <div class="panel form">
      <img id="report-img" style="display:block;max-width:360px;width:100%;border-radius:14px;margin:0 auto 14px;border:1px solid var(--outline)"/>
      <div class="group">
        <label>‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≤‡∏Å AI</label>
        <div class="panel" id="ai-summary" style="padding:12px;font-weight:700;color:#1b5e20">‚Äî</div>
      </div>
      <div class="group">
        <label for="fix-name">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)</label>
        <input id="fix-name" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏•‡∏á/‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á">
      </div>
      <div class="group">
        <label for="desc">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <textarea id="desc" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏•‡πà‡∏≤‡∏á ‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢‡∏ï‡∏≠‡∏ô‡πÄ‡∏¢‡πá‡∏ô ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏Å‡∏±‡∏î‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏Ç‡∏≠‡∏ö‡πÉ‡∏ö ‡∏Ø‡∏•‡∏Ø"></textarea>
      </div>
      <div class="upload-progress" id="rf-progress">
        <div class="bar"><span id="rf-progress-fill"></span></div>
        <div class="txt" id="rf-progress-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶</div>
      </div>
      <div class="actions">
        <button class="btn gray" id="back-to-result"><i class="fa-solid fa-arrow-left"></i>‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
        <button class="btn" id="send-report"><i class="fa-solid fa-paper-plane"></i>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á</button>
      </div>
    </div>
  </section>

  <!-- DIRECT CONTRIBUTION -->
  <section id="direct-contrib-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-heart-circle-plus"></i> ‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI</h2>
    <div class="panel form">
      <p class="center-note">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•</p>

      <div class="group">
        <label for="dc-category">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏≤‡∏û</label>
        <select id="dc-category">
          <option value="insect">‡πÅ‡∏°‡∏•‡∏á</option>
          <option value="corn">‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î</option>
          <option value="sugarcane">‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢</option>
          <option value="cassava">‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á</option>
          <option value="other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
        </select>
      </div>

      <div class="group">
        <label>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î/‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</label>
        <div class="image-box" id="dc-image-box">
          <div id="dc-img-source" class="img-chip" style="display:none">‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á</div>
          <div class="placeholder" id="dc-placeholder"><i class="fa-regular fa-image"></i><div>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</div></div>
          <video id="dc-webcam" autoplay playsinline style="display:none"></video>
          <img id="dc-preview" alt="" style="display:none"/>
        </div>

        <div class="actions" style="justify-content:center">
          <button class="btn" id="dc-capture"><i class="fa-solid fa-camera"></i> ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
          <button class="btn secondary" id="dc-upload"><i class="fa-solid fa-upload"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</button>
          <input type="file" id="dc-file" accept="image/*" capture="environment" hidden>
          <button class="btn gray" id="dc-recapture" style="display:none"><i class="fa-solid fa-eraser"></i> ‡∏ñ‡πà‡∏≤‡∏¢/‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà</button>
          <button class="btn gray" id="dc-clear" style="display:none"><i class="fa-solid fa-eraser"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ</button>
        </div>
      </div>

      <div class="group">
        <label for="dc-true">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)</label>
        <input id="dc-true" placeholder="‡πÄ‡∏ä‡πà‡∏ô Striped Flea Beetle / Leaf Blight ‡∏Ø‡∏•‡∏Ø">
      </div>

      <div class="group">
        <label for="dc-note">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <textarea id="dc-note" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏û ‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏û‡∏ö ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤ ‡∏â‡∏µ‡∏î‡∏™‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏Ø‡∏•‡∏Ø"></textarea>
      </div>

      <div class="upload-progress" id="dc-progress">
        <div class="bar"><span id="dc-progress-fill"></span></div>
        <div class="txt" id="dc-progress-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶</div>
      </div>

      <div class="actions">
        <button class="btn gray" id="dc-back"><i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
        <button class="btn" id="dc-send"><i class="fa-solid fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤</button>
      </div>
    </div>
  </section>

  <!-- ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô -->
  <section id="usage-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-circle-question"></i> ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
    <div class="panel info-body">
      <h3>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</h3>
      <ul class="info-list">
        <li><i class="fa-solid fa-shapes"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</li>
        <li><i class="fa-solid fa-camera"></i> ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏Ñ‡∏°‡∏ä‡∏±‡∏î</li>
        <li><i class="fa-solid fa-magnifying-glass-chart"></i> ‡∏Å‡∏î <b>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à</li>
        <li><i class="fa-solid fa-images"></i> ‡∏ñ‡πà‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏∏‡∏°/‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</li>
        <li><i class="fa-solid fa-heart"></i> ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•</li>
      </ul>

      <div class="disclaimer" style="margin-top:16px">
        <i class="fa-solid fa-triangle-exclamation" style="color:#B26A00;margin-top:2px"></i>
        <div>
          <b>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô/‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:</b> ‡∏ú‡∏•‡∏à‡∏≤‡∏Å AgriCare AI ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á <b>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</b> ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£
        </div>
      </div>

      <div class="info-note">
        <b>‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û:</b> ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á‡∏¢‡πâ‡∏≠‡∏ô ‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö
      </div>

      <div class="info-note">
        <b>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß:</b> ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• AI ‡πÇ‡∏õ‡∏£‡∏î‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ï‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
      </div>

      <div class="actions" style="margin-top:14px">
        <button class="btn gray" onclick="setActivePage('home-page')"><i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
      </div>
    </div>
  </section>

  <!-- ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤ -->
  <section id="about-page" class="page-section">
    <h2 class="section-title"><i class="fa-solid fa-circle-info"></i> ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h2>
    <div class="panel info-body">
      <p><b>AgriCare AI</b> ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏°‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ‡∏û‡∏∑‡∏ä‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏ö‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡∏Ñ‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <b>‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</b> ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</p>

      <h3><i class="fa-solid fa-bullseye"></i> ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</h3>
      <ul class="info-list">
        <li>‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</li>
        <li>‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡πâ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏° ‡πÇ‡∏î‡∏¢ <b>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏õ‡∏•‡∏á</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Ç‡∏≠‡∏á AI</li>
        <li>‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏¢‡∏≤‡∏ß‡∏ä‡∏ô</li>
      </ul>

      <h3><i class="fa-solid fa-microscope"></i> ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</h3>
      <ul class="info-list">
        <li><b>TensorFlow.js</b> ‡πÅ‡∏•‡∏∞ <b>Teachable Machine</b> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• AI ‡∏ö‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</li>
        <li><b>Web APIs</b> ‡πÄ‡∏ä‡πà‡∏ô MediaDevices (‡∏Å‡∏•‡πâ‡∏≠‡∏á), Canvas, ‡πÅ‡∏•‡∏∞ Performance ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏•</li>
        <li><b>Google Apps Script</b> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•</li>
      </ul>

      <h3><i class="fa-solid fa-handshake-angle"></i> ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ</h3>
      <ul class="info-list">
        <li>‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢/‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)</li>
        <li>‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏Ñ‡∏°‡∏ä‡∏±‡∏î ‡∏°‡∏µ‡πÅ‡∏™‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏£‡∏ö‡∏Å‡∏ß‡∏ô</li>
      </ul>

      <div class="disclaimer" style="margin-top:8px">
        <i class="fa-solid fa-triangle-exclamation" style="color:#B26A00;margin-top:2px"></i>
        <div>
          <b>‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:</b> ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á <b>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</b> ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡∏≠‡∏≤‡∏à‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
        </div>
      </div>

      <div class="info-note">
        <b>‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢:</b> ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡πÄ‡∏ó‡∏û‡∏£‡∏±‡∏ï‡∏ô‡∏£‡∏≤‡∏ä‡∏™‡∏∏‡∏î‡∏≤ ‡∏Ø ‡∏™‡∏¢‡∏≤‡∏°‡∏ö‡∏£‡∏°‡∏£‡∏≤‡∏ä‡∏Å‡∏∏‡∏°‡∏≤‡∏£‡∏µ <b>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡πÅ‡∏°‡πà‡∏™‡∏≠‡∏î ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ï‡∏≤‡∏Å</b>
      </div>

      <div class="actions" style="margin-top:14px">
        <button class="btn gray" onclick="setActivePage('home-page')"><i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
      </div>
    </div>
  </section>

</main>

<footer>&copy; 2024 AgriCare AI Project ‚Äî ‡πÉ‡∏ä‡πâ Google Apps Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</footer>

<!-- Floating Back Button -->
<button class="btn back-fab" id="global-back" aria-label="‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö"><i class="fa-solid fa-arrow-left"></i><span id="back-text" style="margin-left:8px">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</span></button>

<!-- Success Modal (Direct Contribution) -->
<div class="modal" id="dc-modal">
  <div class="box">
    <div style="font-size:2rem;line-height:1">üéâ</div>
    <h3>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h3>
    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI! ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•</p>
    <button class="btn ok" id="dc-ok"><i class="fa-solid fa-check"></i> ‡∏ï‡∏Å‡∏•‡∏á</button>
  </div>
</div>

<!-- Success Modal (Report from result) -->
<div class="modal" id="rf-modal">
  <div class="box">
    <div style="font-size:2rem;line-height:1">üéâ</div>
    <h3>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h3>
    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI! ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•</p>
    <button class="btn ok" id="rf-ok"><i class="fa-solid fa-check"></i> ‡∏ï‡∏Å‡∏•‡∏á</button>
  </div>
</div>

<!-- Toast container -->
<div class="toast" id="toast"></div>

<!-- ===== Global Upload Overlay ===== -->
<div class="busy-overlay" id="busy-overlay" aria-modal="true" role="dialog" aria-labelledby="ov-title" aria-describedby="ov-text">
  <div class="busy-box">
    <div class="busy-title" id="ov-title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û</div>
    <div class="ring-wrap">
      <div class="progress-ring" id="ov-ring" style="--pct:0"></div>
      <div class="progress-center" id="ov-pct">0%</div>
    </div>
    <div class="busy-text" id="ov-text">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‚Ä¶</div>
    <div class="busy-loading"><div class="spin"></div><span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></div>
  </div>
</div>

<script>
/* ================== MODEL & DATA =================== */
const MODELS_INFO = {
  insect   : { url:'https://teachablemachine.withgoogle.com/models/gCL-xqZ8C/', title:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏°‡∏•‡∏á', instruction:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏°‡∏•‡∏á' },
  corn     : { url:'https://teachablemachine.withgoogle.com/models/RfjRGiUuH/', title:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', instruction:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î' },
  sugarcane: { url:'https://teachablemachine.withgoogle.com/models/dkwga_Se1/', title:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢', instruction:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢' },
  cassava  : { url:'https://teachablemachine.withgoogle.com/models/ZJc7bDS1R/', title:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á', instruction:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á' }
};

const RESULTS_DATA = {
  "Lady Beetles - ‡∏î‡πâ‡∏ß‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏•‡∏≤‡∏¢":{ type:"beneficial", label:"‡πÅ‡∏°‡∏•‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå",
    info:"‡∏ú‡∏π‡πâ‡∏•‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡∏≠‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡πÅ‡∏õ‡πâ‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡∏´‡∏≠‡∏¢ ‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏¢",
    management:["‡∏≠‡∏ô‡∏∏‡∏£‡∏±‡∏Å‡∏©‡πå‡πÅ‡∏´‡∏•‡πà‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢/‡∏û‡∏∑‡∏ä‡∏î‡∏≠‡∏Å","‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏ß‡πâ‡∏≤‡∏á","‡πÉ‡∏ä‡πâ IPM ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏ß‡∏†‡∏±‡∏ì‡∏ë‡πå"] },
  "Green Lacewing - ‡πÅ‡∏°‡∏•‡∏á‡∏ä‡πâ‡∏≤‡∏á‡∏õ‡∏µ‡∏Å‡πÉ‡∏™":{ type:"beneficial", label:"‡πÅ‡∏°‡∏•‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå",
    info:"‡∏ï‡∏±‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡∏≠‡πà‡∏≠‡∏ô ‡πÑ‡∏£‡πÅ‡∏î‡∏á ‡πÑ‡∏Ç‡πà‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡∏ú‡∏µ‡πÄ‡∏™‡∏∑‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡∏•‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å",
    management:["‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏û‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏´‡πâ‡∏≥","‡∏õ‡∏•‡∏π‡∏Å‡∏û‡∏∑‡∏ä‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏ö‡∏ã‡πà‡∏≠‡∏ô","‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏±‡∏Å/‡∏ú‡∏•‡πÑ‡∏°‡πâ"] },
  "Stink Bug - ‡∏°‡∏ß‡∏ô‡∏û‡∏¥‡∏Ü‡∏≤‡∏ï":{ type:"beneficial", label:"‡πÅ‡∏°‡∏•‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå",
    info:"‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏ß‡∏ô‡πÄ‡∏û‡∏ä‡∏å‡∏Ü‡∏≤‡∏ï‡∏¢‡πà‡∏≠‡∏¢ (Asopinae) ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤‡∏´‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏Ç‡πà‡πÅ‡∏°‡∏•‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä",
    management:["‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏†‡∏≤‡∏û","‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏≤‡∏£‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô","‡∏õ‡∏•‡∏π‡∏Å‡πÅ‡∏ñ‡∏ö‡∏î‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢"] },
  "Assassin Bug - ‡∏°‡∏ß‡∏ô‡πÄ‡∏û‡∏ä‡∏å‡∏Ü‡∏≤‡∏ï":{ type:"beneficial", label:"‡πÅ‡∏°‡∏•‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå",
    info:"‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏≤‡∏Å‡πÅ‡∏ó‡∏á‡∏î‡∏π‡∏î‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠ ‡∏à‡∏±‡∏ö‡∏Å‡∏¥‡∏ô‡πÅ‡∏°‡∏•‡∏á‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏ô‡∏¥‡∏î‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡∏ú‡∏µ‡πÄ‡∏™‡∏∑‡πâ‡∏≠",
    management:["‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ","‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡∏ä‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏¥‡∏ô/‡πÅ‡∏õ‡∏•‡∏á‡∏î‡∏≠‡∏Å","‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö IPM"] },
  "Mealybugs - ‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡πÅ‡∏õ‡πâ‡∏á":{ type:"pest", label:"‡πÅ‡∏°‡∏•‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä",
    info:"‡∏î‡∏π‡∏î‡∏Å‡∏¥‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏û‡πà‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏ß‡∏≤‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏£‡∏≤‡∏î‡∏≥ ‡∏û‡∏∑‡∏ä‡∏ä‡∏∞‡∏á‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏´‡∏á‡∏¥‡∏Å",
    management:["‡∏ï‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏•‡∏î‡πÅ‡∏´‡∏•‡πà‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢","‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡∏Ç‡∏≤‡∏ß","‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏ö‡∏π‡πà‡∏Å‡∏≥‡∏à‡∏±‡∏î‡πÅ‡∏°‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô"] },
  "Cutworm - ‡∏´‡∏ô‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏π‡πâ":{ type:"pest", label:"‡πÅ‡∏°‡∏•‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä",
    info:"‡∏´‡∏ô‡∏≠‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Å‡∏±‡∏î‡∏ï‡πâ‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ö ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏î‡∏¥‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≤‡∏î/‡∏•‡πâ‡∏°",
    management:["‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÑ‡∏Ç‡πà","‡πÉ‡∏ä‡πâ Bt ‡∏ä‡πà‡∏ß‡∏á‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≠‡∏ô‡πÄ‡∏•‡πá‡∏Å","‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å‡∏ü‡∏µ‡πÇ‡∏£‡πÇ‡∏°‡∏ô‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á"] },
  "Striped Flea Beetle - ‡∏î‡πâ‡∏ß‡∏á‡∏´‡∏°‡∏±‡∏î‡∏ú‡∏±‡∏Å‡πÅ‡∏ñ‡∏ö‡∏•‡∏≤‡∏¢":{ type:"pest", label:"‡πÅ‡∏°‡∏•‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä",
    info:"‡∏ï‡∏±‡∏ß‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏¢‡∏ó‡∏≥‡πÉ‡∏ö‡∏û‡∏£‡∏∏‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏ñ‡∏µ‡πà ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≠‡∏ô‡∏Å‡∏±‡∏î‡∏£‡∏≤‡∏Å ‡∏û‡∏ö‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏û‡∏∑‡∏ä‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏Å‡∏∞‡∏´‡∏•‡πà‡∏≥",
    management:["‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏Ç‡πà‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡πÅ‡∏°‡∏•‡∏á/‡∏°‡∏±‡∏•‡∏ä‡πå‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡πÅ‡∏™‡∏á","‡∏õ‡∏•‡∏π‡∏Å‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏ß‡∏±‡∏ä‡∏û‡∏∑‡∏ä","‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏£‡∏û‡∏∑‡∏ä‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏î"] },
  "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ - Leaf Blight":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ",
    info:"‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ Exserohilum (Setosphaeria) turcicum ‡πÅ‡∏ú‡∏•‡∏¢‡∏≤‡∏ß‡∏£‡∏µ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•",
    management:["‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô","‡∏õ‡∏•‡∏π‡∏Å‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏ñ‡∏Å‡∏•‡∏ö‡πÄ‡∏®‡∏©‡∏ã‡∏≤‡∏Å","‡∏û‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏ö"] },
  "‡πÇ‡∏£‡∏Ñ‡∏£‡∏≤‡∏™‡∏ô‡∏¥‡∏° - Corn Rust":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡∏£‡∏≤‡∏™‡∏ô‡∏¥‡∏°",
    info:"‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ Puccinia sorghi ‡∏ó‡∏≥‡∏à‡∏∏‡∏î‡∏ô‡∏π‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏á‡∏™‡∏õ‡∏≠‡∏£‡πå‡∏ö‡∏ô‡πÉ‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î",
    management:["‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô/‡∏õ‡∏•‡∏π‡∏Å‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô","‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏∞‡∏™‡∏°","‡∏û‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏î"] },
  "‡πÇ‡∏£‡∏Ñ‡∏£‡∏≤‡∏™‡∏ô‡∏¥‡∏° - Sugarcane rust":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡∏£‡∏≤‡∏™‡∏ô‡∏¥‡∏°",
    info:"‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ Puccinia sorghi ‡∏ó‡∏≥‡∏à‡∏∏‡∏î‡∏ô‡∏π‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏á‡∏™‡∏õ‡∏≠‡∏£‡πå‡∏ö‡∏ô‡πÉ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢",
    management:["‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô/‡∏õ‡∏•‡∏π‡∏Å‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô","‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏∞‡∏™‡∏°","‡∏û‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏î"] },
  "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á - Yellow Leaf":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á",
    info:"‡∏≠‡πâ‡∏≠‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™ SCYLV ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏•‡∏î‡∏•‡∏á",
    management:["‡πÉ‡∏ä‡πâ‡∏ó‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏õ‡∏•‡∏≠‡∏î‡πÇ‡∏£‡∏Ñ","‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏û‡∏•‡∏µ‡πâ‡∏¢‡∏≠‡πà‡∏≠‡∏ô‡∏û‡∏≤‡∏´‡∏∞","‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á"] },
  "‡πÇ‡∏£‡∏Ñ‡πÄ‡∏´‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏ô‡πà‡∏≤‡πÅ‡∏î‡∏á - Red Rot":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡πÄ‡∏´‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏ô‡πà‡∏≤‡πÅ‡∏î‡∏á",
    info:"‡∏≠‡πâ‡∏≠‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ Colletotrichum falcatum ‡∏•‡∏≥‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÉ‡∏ô‡πÅ‡∏î‡∏á‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß ‡∏°‡∏µ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏´‡∏°‡∏±‡∏Å",
    management:["‡πÉ‡∏ä‡πâ‡∏ó‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô","‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥","‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏π‡∏Å‡∏ã‡πâ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á"] },
  "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ - Cassava Bacterial Blight":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢",
    info:"‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢ Xanthomonas phaseoli pv. manihotis ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏à‡∏∏‡∏î‡∏â‡πà‡∏≥‡∏ô‡πâ‡∏≥ ‡πÅ‡∏ú‡∏•‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏£‡πà‡∏ß‡∏á",
    management:["‡πÉ‡∏ä‡πâ‡∏ó‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏õ‡∏•‡∏≠‡∏î‡πÇ‡∏£‡∏Ñ","‡∏ï‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏≤‡∏ó‡∏≥‡∏•‡∏≤‡∏¢","‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏î/‡∏ù‡∏ô‡∏ä‡∏∏‡∏Å"] },
  "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏î‡πà‡∏≤‡∏á - Cassava Mosaic":{ type:"disease", label:"‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏î‡πà‡∏≤‡∏á",
    info:"‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏à‡∏°‡∏¥‡∏ô‡∏¥‡πÑ‡∏ß‡∏£‡∏±‡∏™ (‡πÄ‡∏ä‡πà‡∏ô ACMV/ICMV) ‡∏ó‡∏≥‡πÉ‡∏ö‡∏î‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡πÉ‡∏ö‡∏´‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡πÅ‡∏Ñ‡∏£‡∏∞",
    management:["‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô","‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏°‡∏•‡∏á‡∏´‡∏ß‡∏µ‡πà‡∏Ç‡∏≤‡∏ß‡∏û‡∏≤‡∏´‡∏∞","‡∏ñ‡∏≠‡∏ô‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏ó‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏à‡∏≤‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏î"] },
  "‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏£‡∏Ñ‡∏ó‡∏≤‡∏á‡πÉ‡∏ö - Healthy Leaf":{ type:"healthy", label:"‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ",
    info:"‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏Ñ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏°‡∏•‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ö‡∏ô‡πÉ‡∏ö‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤",
    management:["‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥","‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠"] },
  "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏î‡πâ":{ type:"unknown", label:"‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",
    info:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ï‡πà‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡∏†‡∏≤‡∏û‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    management:[] }
};

/* ================== GLOBAL =================== */
let currentModelKey = null;
let currentModel = null;
let lastPrediction = null;
let capturedImageDataUrl = null;
let dcImageDataUrl = null;

const CONF_LIMIT = 0.80;
const UNKNOWN_NAME = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏î‡πâ";

const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));

/* ---------- [FIX] ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤ key ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î ---------- */
// ‡∏ó‡∏≥‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ä‡∏∑‡πà‡∏≠: ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≤‡∏¢-‡∏´‡∏±‡∏ß, ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô lower, ‡∏£‡∏ß‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≥, ‡∏£‡∏ß‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏µ‡∏î‡∏ó‡∏∏‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô '-'
function normalizeKey(s){
  return String(s ?? '')
    .replace(/[‚Äì‚Äî]/g,'-')                 // en/em dash -> hyphen
    .normalize('NFKC')                    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö unicode ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
    .trim()
    .toLowerCase()
    .replace(/\s*-\s*/g,' - ')            // ‡∏ö‡∏µ‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠‡∏ö '-'
    .replace(/\s+/g,' ');                 // ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
}
// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö normalized ‡∏à‡∏≤‡∏Å RESULTS_DATA
const RESULTS_DATA_LOOKUP = (() => {
  const map = new Map();
  Object.keys(RESULTS_DATA).forEach(k => {
    map.set(normalizeKey(k), RESULTS_DATA[k]);
  });
  return map;
})();
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏≤‡∏™ (‡∏•‡∏≠‡∏á exact -> normalized)
function getResultData(label){
  if (RESULTS_DATA[label]) return RESULTS_DATA[label];
  return RESULTS_DATA_LOOKUP.get(normalizeKey(label));
}
/* ---------- [END FIX] ---------- */

/* Lazy-load libs */
let libsLoaded = false;
function loadScript(src){
  return new Promise((resolve,reject)=>{
    const s = document.createElement('script');
    s.src = src; s.defer = true; s.onload = resolve; s.onerror = reject;
    document.head.appendChild(s);
  });
}
async function ensureAILibs(){
  if(libsLoaded) return;
  await loadScript('https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js');
  try{
    if(window.tf){
      await tf.ready();
      try{ await tf.setBackend('webgl'); await tf.ready(); }catch(e){}
    }
  }catch(e){}
  await loadScript('https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js');
  libsLoaded = true;
}

/* Prefetch ‡πÇ‡∏°‡πÄ‡∏î‡∏•/weights */
async function prefetchModel(url){
  try{
    const mj = await fetch(url+'model.json', {cache:'force-cache'});
    if(mj.ok){
      const j = await mj.json();
      fetch(url+'metadata.json', {cache:'force-cache'}).catch(()=>{});
      const manifests = (j.weightsManifest||[]);
      for(const m of manifests){
        for(const p of (m.paths||[])){
          fetch(url + p, {cache:'force-cache'}).catch(()=>{});
        }
      }
    }else{
      fetch(url+'metadata.json', {mode:'no-cors'}).catch(()=>{});
      fetch(url+'weights.bin', {mode:'no-cors'}).catch(()=>{});
    }
  }catch(e){
    fetch(url+'model.json', {mode:'no-cors'}).catch(()=>{});
    fetch(url+'metadata.json', {mode:'no-cors'}).catch(()=>{});
    fetch(url+'weights.bin', {mode:'no-cors'}).catch(()=>{});
  }
}

/* Steps/Nav */
let currentPageId = 'home-page';
let currentStepIdx = 0;

function layoutStepsFill(idx){
  const stepsEl = $('#steps');
  if(stepsEl.style.display==='none') return;
  const dots = stepsEl.querySelectorAll('.step .dot');
  if(dots.length < 2) return;

  const rect = stepsEl.getBoundingClientRect();
  const centers = [...dots].map(d => {
    const r = d.getBoundingClientRect();
    return (r.left + r.width/2) - rect.left;
  });

  const first = centers[0];
  const last  = centers[centers.length-1];

  const line = $('#steps-line');
  const fill = $('#steps-fill');

  line.style.left  = Math.round(first) + 'px';
  line.style.width = Math.max(0, Math.round(last - first)) + 'px';

  fill.style.left  = Math.round(first) + 'px';
  const target = Math.max(0, Math.min(idx, centers.length-1));
  fill.style.width = Math.max(0, Math.round(centers[target] - first)) + 'px';
}

function updateSteps(activeId){
  const steps = $('#steps');
  const mapping = { 'home-page':'home','analysis-page':'analysis','result-page':'result','report-feedback-page':'report' };
  const show = ['analysis-page','result-page','report-feedback-page'].includes(activeId);
  steps.style.display = show ? '' : 'none';
  const current = mapping[activeId];
  const order = ['home','analysis','result','report'];
  const idxCur = order.indexOf(current);
  currentStepIdx = Math.max(0, idxCur);

  $$('.steps .step').forEach(node=>{
    const key = node.dataset.step;
    const idxKey = order.indexOf(key);
    node.classList.remove('active','done');
    if(idxKey < idxCur) node.classList.add('done');
    if(idxKey === idxCur) node.classList.add('active');
  });

  if(show) layoutStepsFill(currentStepIdx);
}

function updateNavVisibility(activeId){
  const top = document.getElementById('top-nav');
  if (!top) return;
  const hideNav = ['home-page','direct-contrib-page','usage-page','about-page'].includes(activeId);
  top.style.display = hideNav ? 'none' : '';
}

/* Floating Back Button */
const PREV_PAGE = {
  'analysis-page':'home-page',
  'result-page':'analysis-page',
  'report-feedback-page':'result-page',
  'direct-contrib-page':'home-page',
  'usage-page':'home-page',
  'about-page':'home-page'
};
function updateBackFab(){
  const fab = $('#global-back');
  if(currentPageId==='home-page'){ fab.style.display='none'; return; }
  const target = PREV_PAGE[currentPageId];
  if(!target){ fab.style.display='none'; return; }
  fab.onclick = ()=> setActivePage(target);
  fab.style.display='inline-flex';
}

async function setActivePage(id){
  if(currentPageId === 'analysis-page' && id !== 'analysis-page'){ stopWebcam(); }
  if(currentPageId === 'direct-contrib-page' && id !== 'direct-contrib-page'){ stopDCWebcam(); }

  $$('.page-section').forEach(el=>el.classList.remove('active'));
  $('#'+id).classList.add('active');
  $$('#top-nav a').forEach(a=>{
    a.classList.toggle('active', a.dataset.target===id);
    if(['result-page','report-feedback-page'].includes(a.dataset.target)){
      a.style.display = (id===a.dataset.target) ? 'inline-flex'
        : (id==='result-page' && a.dataset.target==='report-feedback-page' ? 'inline-flex'
        : (id==='report-feedback-page' && a.dataset.target==='result-page' ? 'inline-flex':'none'));
    }
  });
  updateNavVisibility(id);
  updateSteps(id);
  currentPageId = id;
  updateBackFab();

  if(id === 'analysis-page'){
    const v = $('#webcam');
    const pv = $('#preview');
    const ph = $('#placeholder');
    if(pv){ pv.style.display='none'; pv.src=''; }
    if(ph){ ph.style.display=''; }
    const btnAnalyze = $('#analyze'); if(btnAnalyze){ btnAnalyze.style.display='none'; btnAnalyze.disabled = true; btnAnalyze.title='‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ'; btnAnalyze.classList.remove('pulse-once');}
    const btnRecap  = $('#recapture'); if(btnRecap) btnRecap.style.display='none';

    const hasActiveStream = hasLiveStream();
    if(currentModel && !hasActiveStream){
      await initWebcam();
      try{ await v.play?.(); }catch(e){}
    }else if(v && hasActiveStream){
      v.style.display='block';
      if(ph) ph.style.display='none';
    }
    const chip = $('#img-source'); if(chip){ chip.style.display = hasActiveStream ? '' : 'none'; chip.textContent = hasActiveStream ? '‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏™‡∏î)' : '‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û'; }
  }

  if(id === 'direct-contrib-page'){
    $('#dc-preview').style.display='none';
    $('#dc-webcam').style.display='none';
    $('#dc-placeholder').style.display='';
    $('#dc-recapture').style.display='none';
    $('#dc-clear').style.display='none';
    $('#dc-img-source').style.display='none';
  }
}

/* Helpers */
function toModelCanvasFromImage(img){
  const c=document.createElement('canvas');
  c.width=224; c.height=224;
  c.getContext('2d').drawImage(img,0,0,224,224);
  return c;
}
async function compressDataUrl(dataUrl, maxDim=1600, quality=0.75){
  try{
    const img = new Image();
    img.src = dataUrl;
    await img.decode();
    let {width, height} = img;
    const scale = Math.min(1, maxDim/Math.max(width,height));
    const w = Math.round(width*scale);
    const h = Math.round(height*scale);
    const c = document.createElement('canvas'); c.width=w; c.height=h;
    c.getContext('2d').drawImage(img,0,0,w,h);
    return c.toDataURL('image/jpeg', quality);
  }catch(e){
    console.warn('compress failed', e);
    return dataUrl;
  }
}

/* Toast */
function showToast(msg, type='info', timeout=3000){
  const wrap = $('#toast');
  const el = document.createElement('div');
  el.className = `toast-item ${type}`;
  el.textContent = msg;
  wrap.appendChild(el);
  setTimeout(()=>{ el.style.opacity='0'; el.style.transform='translateY(6px)'; }, timeout-300);
  setTimeout(()=>{ wrap.removeChild(el); }, timeout);
}

/* ====== CAMERA (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) ====== */
let trackZoomSupported = false;
let zoomCaps = {min:1, max:3, step:0.1};
let currentZoom = 1;
let lastNonOneZoom = 2;
function hasLiveStream(){
  const v = $('#webcam');
  return !!(v && v.srcObject && typeof v.srcObject.getTracks==='function' &&
            v.srcObject.getTracks().some(t=>t.readyState==='live'));
}
async function initWebcam(){
  $('#loading').style.display='flex';
  $('#loading-text').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‚Ä¶';
  $('#analysis-page').setAttribute('aria-busy','true');

  const v = $('#webcam');
  try{
    const dpr = Math.min(2, window.devicePixelRatio || 1);
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ facingMode:'environment', width:{ideal:Math.round(1280*dpr)}, height:{ideal:Math.round(720*dpr)} }
    });
    v.srcObject = stream;
    v.style.display='block';
    $('#placeholder').style.display='none';
    const chip = $('#img-source'); if(chip){ chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏™‡∏î)'; }

    await enhanceCameraTrack(stream);
    setupZoomControls(stream);
    bindPinchToZoom();
    bindDoubleTapZoom(v);
  }catch(e){
    console.warn(e);
    showToast('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÅ‡∏ó‡∏ô', 'error');
  }finally{
    $('#analysis-page').removeAttribute('aria-busy');
    $('#loading').style.display='none';
  }
}
async function enhanceCameraTrack(stream){
  try{
    const track = stream.getVideoTracks()[0];
    if(track && track.getCapabilities){
      const caps = track.getCapabilities();
      if(caps.focusMode && caps.focusMode.includes('continuous')){
        try{ await track.applyConstraints({advanced:[{focusMode:'continuous'}]}); }catch(e){}
      }
      if(caps.exposureMode && caps.exposureMode.includes('continuous')){
        try{ await track.applyConstraints({advanced:[{exposureMode:'continuous'}]}); }catch(e){}
      }
    }
  }catch(e){}
}
function stopWebcam(){
  const v = $('#webcam');
  const stream = v && v.srcObject;
  if(stream && typeof stream.getTracks === 'function'){ stream.getTracks().forEach(t => t.stop()); }
  if(v){ v.srcObject = null; v.style.display='none'; v.style.transform='none'; }
  const ph = $('#placeholder'); if(ph){ ph.style.display=''; }
  const chip = $('#img-source'); if(chip){ chip.style.display='none'; }
  hideZoomControls();
  unbindPinchToZoom();
}

/* Zoom UI (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) */
function setupZoomControls(stream){
  const wrap = $('#zoom-wrap');
  const range = $('#zoom-range');
  const v = $('#webcam');
  const lbl = $('#zoom-level');
  const track = stream.getVideoTracks()[0];
  trackZoomSupported = false;
  currentZoom = 1;

  if(track.getCapabilities){
    const caps = track.getCapabilities();
    if(caps && typeof caps.zoom === 'object'){
      trackZoomSupported = true;
      zoomCaps = {min:caps.zoom.min ?? 1, max:caps.zoom.max ?? 3, step:caps.zoom.step ?? 0.1};
      const setts = track.getSettings ? track.getSettings() : {};
      currentZoom = setts.zoom ?? 1;
    }
  }
  if(!trackZoomSupported){
    zoomCaps = {min:1, max:3, step:0.1};
    currentZoom = 1;
    v.style.transform = 'scale(1)';
  }

  range.min = zoomCaps.min;
  range.max = zoomCaps.max;
  range.step = zoomCaps.step;
  range.value = currentZoom;
  lbl.textContent = `${currentZoom.toFixed(1)}√ó`;
  wrap.style.display = '';

  range.oninput = ()=> applyZoom(parseFloat(range.value));
  $('#zoom-in').onclick = ()=>{ const val=Math.min(parseFloat(range.value)+zoomCaps.step, zoomCaps.max); range.value=val; applyZoom(val); };
  $('#zoom-out').onclick = ()=>{ const val=Math.max(parseFloat(range.value)-zoomCaps.step, zoomCaps.min); range.value=val; applyZoom(val); };

  const box = $('#image-box');
  box.onwheel = (e)=>{
    if(!hasLiveStream()) return;
    e.preventDefault();
    const delta = Math.sign(e.deltaY) * (-zoomCaps.step);
    let val = parseFloat(range.value) + delta;
    val = Math.min(zoomCaps.max, Math.max(zoomCaps.min, val));
    range.value = val; applyZoom(val);
  };

  window.addEventListener('resize', ()=> layoutStepsFill(currentStepIdx));
  window.addEventListener('orientationchange', ()=> {
    setTimeout(()=>applyZoom(parseFloat(range.value)), 250);
    setTimeout(()=>layoutStepsFill(currentStepIdx), 300);
  }, {passive:true});
}
function hideZoomControls(){
  const wrap = $('#zoom-wrap');
  if(wrap){ wrap.style.display='none'; }
  const box = $('#image-box');
  box.onwheel = null;
}
async function applyZoom(val){
  const v = $('#webcam');
  const lbl = $('#zoom-level');
  currentZoom = Math.min(zoomCaps.max, Math.max(zoomCaps.min, val));
  if(currentZoom !== 1) lastNonOneZoom = currentZoom;

  if(trackZoomSupported && hasLiveStream()){
    try{
      const track = v.srcObject.getVideoTracks()[0];
      if(track.applyConstraints){
        await track.applyConstraints({ zoom: currentZoom }).catch(()=>track.applyConstraints({advanced:[{zoom:currentZoom}]}));
      }
    }catch(e){
      v.style.transform = `scale(${currentZoom})`;
    }
  }else{
    v.style.transform = `scale(${currentZoom})`;
  }
  lbl.textContent = `${currentZoom.toFixed(1)}√ó`;
}

/* Pinch to zoom (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) */
let pinchBound = false, pinchStartDist = 0, pinchStartZoom = 1;
function bindPinchToZoom(){
  if(pinchBound) return;
  const box = $('#image-box');
  const range = $('#zoom-range');

  function distance(t1,t2){
    const dx = t1.clientX - t2.clientX;
    const dy = t2.clientY - t1.clientY;
    return Math.hypot(dx,dy);
  }
  function onStart(e){
    if(e.touches && e.touches.length===2){
      pinchStartDist = Math.hypot(
        e.touches[0].clientX - e.touches[1].clientX,
        e.touches[0].clientY - e.touches[1].clientY
      );
      pinchStartZoom = parseFloat(range.value);
    }
  }
  function onMove(e){
    if(e.touches && e.touches.length===2){
      e.preventDefault();
      const d = Math.hypot(
        e.touches[0].clientX - e.touches[1].clientX,
        e.touches[0].clientY - e.touches[1].clientY
      );
      const scale = d / (pinchStartDist||d);
      let val = pinchStartZoom * scale;
      val = Math.min(zoomCaps.max, Math.max(zoomCaps.min, val));
      range.value = val;
      applyZoom(val);
    }
  }
  box.addEventListener('touchstart', onStart, {passive:false});
  box.addEventListener('touchmove', onMove, {passive:false});
  pinchBound = true;
  box._pinchHandlers = {onStart,onMove};
}
function unbindPinchToZoom(){
  const box = $('#image-box');
  if(!box || !pinchBound) return;
  const {onStart,onMove} = box._pinchHandlers || {};
  if(onStart) box.removeEventListener('touchstart', onStart);
  if(onMove) box.removeEventListener('touchmove', onMove);
  pinchBound = false;
}
function bindDoubleTapZoom(videoEl){
  let lastTap = 0;
  videoEl.addEventListener('touchend', ()=>{
    const now = Date.now();
    if(now - lastTap < 260){
      const range = $('#zoom-range');
      const target = (parseFloat(range.value) === 1 ? lastNonOneZoom : 1);
      range.value = target;
      applyZoom(target);
    }
    lastTap = now;
  }, {passive:true});
}

/* ====== MODEL CACHE + LOAD ====== */
const MODEL_CACHE = new Map();
const MODEL_LOADING = new Map();

async function loadModel(url){
  $('#loading').style.display='flex';
  $('#loading-text').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‚Ä¶';
  $('#analysis-page').setAttribute('aria-busy','true');
  try{
    const m = await tmImage.load(url+'model.json', url+'metadata.json');
    return m;
  }catch(e){
    console.error(e);
    showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏î‡πâ', 'error');
    return null;
  }finally{
    $('#analysis-page').removeAttribute('aria-busy');
    $('#loading').style.display='none';
  }
}
async function warmupModel(model){
  try{
    const c = document.createElement('canvas');
    c.width = 224; c.height = 224;
    const g = c.getContext('2d');
    g.fillStyle = '#ffffff'; g.fillRect(0,0,224,224);
    await model.predict(c);
  }catch(e){}
}
async function getModelByKey(key){
  if(MODEL_CACHE.has(key)) return MODEL_CACHE.get(key);
  if(MODEL_LOADING.has(key)) return MODEL_LOADING.get(key);

  const mInfo = MODELS_INFO[key];
  const p = (async ()=>{
    await ensureAILibs();
    prefetchModel(mInfo.url);
    const m = await loadModel(mInfo.url);
    if(m){ MODEL_CACHE.set(key, m); warmupModel(m); }
    MODEL_LOADING.delete(key);
    return m;
  })();

  MODEL_LOADING.set(key, p);
  return p;
}

/* ====== Capture/preview/analyze (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) ====== */
function captureFromWebcam(){
  const v = $('#webcam');
  const c = document.createElement('canvas');
  c.width=v.videoWidth; c.height=v.videoHeight;
  c.getContext('2d').drawImage(v,0,0,c.width,c.height);
  capturedImageDataUrl = c.toDataURL('image/jpeg');
  if(navigator.vibrate){ try{ navigator.vibrate(15); }catch(e){} }
  showPreview(capturedImageDataUrl);
}
function showPreview(dataURL){
  const img = $('#preview');
  img.src=dataURL; img.style.display='block';
  $('#webcam').style.display='none';
  $('#placeholder').style.display='none';
  const analyzeBtn = $('#analyze');
  analyzeBtn.style.display='inline-flex';
  analyzeBtn.disabled = false;
  analyzeBtn.title = '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û';
  analyzeBtn.classList.add('pulse-once');       // üëâ ‡∏î‡∏∂‡∏á‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  $('#recapture').style.display='inline-flex';
  $('#sr-status').textContent = '‡∏°‡∏µ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå';
  const chip = $('#img-source'); if(chip){ chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î'; }
  hideZoomControls();
}
async function analyze(){
  if(!capturedImageDataUrl){ showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô', 'error'); return; }
  if(!currentModel){ showToast('‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏´‡∏°‡πà', 'error'); return; }

  const analyzeBtn = $('#analyze');
  analyzeBtn.classList.add('loading');
  analyzeBtn.disabled = true;
  analyzeBtn.classList.remove('pulse-once');
  $('#sr-status').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‚Ä¶';

  $('#loading').style.display='flex';
  $('#loading-text').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‚Ä¶';
  $('#analysis-page').setAttribute('aria-busy','true');
  try{
    const tmpImg = new Image(); tmpImg.src = capturedImageDataUrl; await tmpImg.decode();
    const modelInputCanvas = toModelCanvasFromImage(tmpImg);
    const prediction = await currentModel.predict(modelInputCanvas);
    prediction.sort((a,b)=>b.probability-a.probability);
    lastPrediction = prediction;

    renderResult(prediction[0]);
    setActivePage('result-page');
  }catch(e){
    console.error(e);
    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û', 'error');
  }finally{
    analyzeBtn.classList.remove('loading');
    analyzeBtn.disabled = false;
    $('#analysis-page').removeAttribute('aria-busy');
    $('#loading').style.display='none';
  }
}

/* ===== RENDER RESULT ===== */
function renderResult(top){
  $('#result-image').src = capturedImageDataUrl;

  const percent = Math.round(top.probability*100);
  const isUnknownPred = (top.className === UNKNOWN_NAME);
  const lowConfidence = (top.probability < CONF_LIMIT);
  const showAsUnknown = isUnknownPred || lowConfidence;

  const typeEl = $('#result-type');

  /* [FIX] ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢ getResultData() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏≤ key ‡πÅ‡∏ö‡∏ö‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô */
  const foundData = getResultData(top.className); // <‚Äî ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà
  const dataForDisplay = showAsUnknown
    ? (RESULTS_DATA[UNKNOWN_NAME] || {type:'unknown', label:'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'})
    : (foundData || {type:'unknown', label:'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'});
  /* [END FIX] */

  typeEl.className = 'badge ' + (dataForDisplay.type || 'unknown');
  typeEl.innerHTML = `<i class="fa-solid fa-tag"></i><b>${dataForDisplay.label}</b>`;
  $('#result-name').textContent = showAsUnknown ? UNKNOWN_NAME : top.className;

  const meterFill = $('#conf-fill');
  const bubble = $('#conf-bubble');
  if (showAsUnknown) {
    meterFill.style.width = '50%';
    bubble.textContent = '‡∏ï‡πà‡∏≥';
  } else {
    meterFill.style.width = percent + '%';
    bubble.textContent = `${percent}%`;
  }

  const infoBox = $('#result-info');
  const disclaimerBox = $('#result-disclaimer');

  if (showAsUnknown) {
    infoBox.innerHTML = `
      <div class="unknown-box">
        <b>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å</b>
        <div class="adv"><i class="fa-solid fa-eye-slash"></i> ‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡πÅ‡∏™‡∏á‡∏ô‡πâ‡∏≠‡∏¢/‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ</div>
        <div class="adv"><i class="fa-solid fa-image"></i> ‡∏°‡∏∏‡∏°‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î</div>
        <div class="adv"><i class="fa-solid fa-database"></i> ‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•</div>
      </div>`;
    disclaimerBox.innerHTML = '';
  } else {
    infoBox.innerHTML = `
      <div class="block">
        <h4><i class="fa-solid fa-circle-info"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h4>
        <p>${dataForDisplay.info || '-'}</p>
        <h4><i class="fa-solid fa-clipboard-check"></i>‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</h4>
        <ul class="list">
          ${(dataForDisplay.management||[]).map(t=>`<li><i class="fa-solid fa-check-circle"></i>${t}</li>`).join('')}
        </ul>
      </div>
    `;
    if (percent >= 80){
      disclaimerBox.innerHTML = `
        <div class="disclaimer">
          <i class="fa-solid fa-triangle-exclamation" style="color:#B26A00;margin-top:2px"></i>
          <div><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å AI ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏î ‡πÜ</div>
        </div>`;
    }else{
      disclaimerBox.innerHTML = '';
    }
  }

  const near = lastPrediction
    .filter(p => p.className !== UNKNOWN_NAME && (!(!showAsUnknown) ? true : p.className !== top.className))
    .slice(0, 3)
    .map(p => `<li><i class="fa-regular fa-circle-check"></i> ${p.className} ‚Äì ${Math.round(p.probability*100)}%</li>`)
    .join('');
  $('#nearby-list').innerHTML = near;

  $('#report-img').src = capturedImageDataUrl;
  $('#ai-summary').textContent = showAsUnknown ? UNKNOWN_NAME : top.className;
}

/* Nav / Events */
function bindNav(){
  $$('#top-nav a').forEach(a=>{
    a.addEventListener('click',e=>{
      e.preventDefault();
      setActivePage(a.dataset.target);
    });
  });
}

/* Home Cards */
function bindHomeCards(){
  $$('.feature').forEach(card=>{
    const key = card.dataset.model;
    const url = MODELS_INFO[key].url;

    card.addEventListener('mouseenter', ()=>prefetchModel(url));
    card.addEventListener('focusin', ()=>prefetchModel(url));

    card.addEventListener('click', async ()=>{
      currentModelKey = key;
      const mInfo = MODELS_INFO[key];
      $('#analysis-title').textContent = mInfo.title;
      $('#instruction').textContent = mInfo.instruction;

      setActivePage('analysis-page');

      const modelPromise = getModelByKey(key);
      const webcamPromise = initWebcam();

      currentModel = await modelPromise;
      await webcamPromise;
    });
  });
  $('#contribute-data-home').addEventListener('click',()=>setActivePage('direct-contrib-page'));
  $('#usage-btn').addEventListener('click',()=>setActivePage('usage-page'));
  $('#about-btn').addEventListener('click',()=>setActivePage('about-page'));
}
function bindAnalysisButtons(){
  $('#capture').addEventListener('click',captureFromWebcam);
  $('#upload').addEventListener('click',()=>$('#file-input').click());
  $('#file-input').addEventListener('change',e=>{
    if(e.target.files?.length){
      const file=e.target.files[0];
      const r=new FileReader();
      r.onload=ev=>{ capturedImageDataUrl=ev.target.result; showPreview(capturedImageDataUrl); };
      r.readAsDataURL(file);
    }
  });
  $('#analyze').addEventListener('click',analyze);
  $('#recapture').addEventListener('click',()=>{
    $('#preview').style.display='none'; $('#webcam').style.display='block';
    const analyzeBtn = $('#analyze');
    analyzeBtn.style.display='none'; analyzeBtn.disabled=true; analyzeBtn.title='‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ';
    analyzeBtn.classList.remove('pulse-once');
    $('#recapture').style.display='none';
    const chip = $('#img-source'); if(chip){ chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏™‡∏î)'; }
    setupZoomControls($('#webcam').srcObject);
  });
}
function bindResultButtons(){
  $('#again').addEventListener('click',()=>setActivePage('analysis-page'));
  $('#go-report').addEventListener('click',()=>setActivePage('report-feedback-page'));
  $('#back-to-result').addEventListener('click',()=>setActivePage('result-page'));
}

/* GAS */
const GAS_URL = 'https://script.google.com/macros/s/AKfycbzxMcdkHDEBPv5aspReCHxOW6lh_Y00O3wWQLpeIR43KhKNjV70Cli9z9fuK4GRHNV7/exec';
async function submitData(payload){
  try{
    payload.timestamp = new Date().toISOString();
    await fetch(GAS_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    return true;
  }catch(err){ console.error(err); return false; }
}

/* Overlay controller */
const ProgressOverlay = {
  open({title='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û', text='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‚Ä¶'} = {}){
    const ov = $('#busy-overlay');
    $('#ov-title').textContent = title;
    $('#ov-text').textContent = text;
    $('#ov-pct').textContent = '0%';
    $('#ov-ring').style.setProperty('--pct', 0);
    ov.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    return {
      update(pct, msg){
        const p = Math.max(0, Math.min(100, Math.round(pct)));
        $('#ov-ring').style.setProperty('--pct', p);
        $('#ov-pct').textContent = p + '%';
        if(msg) $('#ov-text').textContent = msg;
      },
      close(){
        ov.style.display = 'none';
        document.body.style.overflow = '';
      }
    };
  }
};

/* ‡∏à‡∏≥‡∏•‡∏≠‡∏á progress */
function simulateProgress(fillEl, textEl, onProgress){
  let p = 5;
  fillEl.style.width = '5%';
  textEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶';
  onProgress?.(p);
  const timer = setInterval(()=>{
    p += Math.random()*8+3;
    if(p >= 90) p = 90;
    fillEl.style.width = p+'%';
    onProgress?.(p);
  }, 250);
  return {
    complete(success=true){
      clearInterval(timer);
      fillEl.style.width = '100%';
      textEl.textContent = success ? '‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
      onProgress?.(100);
    }
  };
}

/* ===== ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ===== */
document.getElementById('send-report').addEventListener('click',async ()=>{
  const btn = document.getElementById('send-report');
  btn.classList.add('loading'); btn.disabled = true;

  const overlay = ProgressOverlay.open({title:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û', text:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‚Ä¶'});

  const pr = $('#rf-progress'), fill = $('#rf-progress-fill'), txt = $('#rf-progress-text');
  pr.style.display = '';
  const sim = simulateProgress(fill, txt, (pct)=> overlay.update(pct, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶'));

  const compressed = await compressDataUrl(capturedImageDataUrl, 1600, 0.75);

  const ai = document.getElementById('ai-summary').textContent.trim();
  const fix = document.getElementById('fix-name').value.trim();
  const desc= document.getElementById('desc').value.trim();
  const payload = {
    type:'report',
    category: currentModelKey,
    imageData: compressed || capturedImageDataUrl,
    aiPrediction: ai,
    aiConfidence: (lastPrediction && lastPrediction[0]) ? lastPrediction[0].probability.toFixed(4) : '',
    userCorrection: fix,
    userDescription: desc
  };
  const ok = await submitData(payload);
  sim.complete(!!ok);

  setTimeout(()=>{
    pr.style.display='none';
    btn.classList.remove('loading'); btn.disabled = false;
    overlay.update(100, ok ? '‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    setTimeout(()=> overlay.close(), 450);
    if(ok){
      const modal = document.getElementById('rf-modal');
      const okBtn = document.getElementById('rf-ok');
      modal.style.display = 'flex';
      okBtn.focus();
    }else{
      showToast('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
    }
  }, 350);
});
document.getElementById('rf-ok').addEventListener('click', ()=>{
  document.getElementById('rf-modal').style.display='none';
  setActivePage('home-page');
});

/* ===== Direct Contribution ===== */
function hasLiveDCStream(){
  const v = $('#dc-webcam');
  return !!(v && v.srcObject && typeof v.srcObject.getTracks==='function' &&
            v.srcObject.getTracks().some(t=>t.readyState==='live'));
}
async function initDCWebcam(){
  try{
    const dpr = Math.min(2, window.devicePixelRatio || 1);
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ facingMode:'environment', width:{ideal:Math.round(1280*dpr)}, height:{ideal:Math.round(720*dpr)} }
    });
    const v = $('#dc-webcam');
    v.srcObject = stream;
    v.style.display='block';
    $('#dc-placeholder').style.display='none';
    const chip = $('#dc-img-source'); chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏™‡∏î)';
  }catch(e){
    console.warn(e);
    showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÅ‡∏ó‡∏ô', 'error');
  }
}
function stopDCWebcam(){
  const v = $('#dc-webcam');
  const stream = v && v.srcObject;
  if(stream && typeof stream.getTracks==='function'){ stream.getTracks().forEach(t=>t.stop()); }
  if(v){ v.srcObject = null; v.style.display='none'; }
}
function captureFromDCWebcam(){
  const v = $('#dc-webcam');
  if(!hasLiveDCStream()){ initDCWebcam(); return; }
  const c = document.createElement('canvas');
  c.width = v.videoWidth; c.height = v.videoHeight;
  c.getContext('2d').drawImage(v,0,0,c.width,c.height);
  dcImageDataUrl = c.toDataURL('image/jpeg');
  $('#dc-preview').src = dcImageDataUrl;
  $('#dc-preview').style.display='block';
  $('#dc-webcam').style.display='none';
  $('#dc-recapture').style.display='inline-flex';
  $('#dc-clear').style.display='inline-flex';
  const chip = $('#dc-img-source'); chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß)';
  stopDCWebcam();
}
function showDCPreview(dataURL){
  dcImageDataUrl = dataURL;
  const img = $('#dc-preview');
  img.src = dataURL;
  img.style.display='block';
  $('#dc-webcam').style.display='none';
  $('#dc-placeholder').style.display='none';
  $('#dc-recapture').style.display='inline-flex';
  $('#dc-clear').style.display='inline-flex';
  const chip = $('#dc-img-source'); chip.style.display=''; chip.textContent='‡πÅ‡∏´‡∏•‡πà‡∏á‡∏†‡∏≤‡∏û: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î';
}

function bindDirectContribution(){
  const uploadBtn = $('#dc-upload');
  const fileInput = $('#dc-file');
  const preview   = $('#dc-preview');
  const clearBtn  = $('#dc-clear');
  const recaptureBtn = $('#dc-recapture');
  const captureBtn = $('#dc-capture');
  const modal     = $('#dc-modal');
  const modalOk   = $('#dc-ok');

  uploadBtn.addEventListener('click', ()=> fileInput.click());
  fileInput.addEventListener('change', (e)=>{
    if(e.target.files?.length){
      const f=e.target.files[0];
      const r=new FileReader();
      r.onload=ev=>{ showDCPreview(ev.target.result); };
      r.readAsDataURL(f);
    }
  });

  captureBtn.addEventListener('click', async ()=>{
    if(!hasLiveDCStream()){
      await initDCWebcam();
      captureBtn.blur();
    }else{
      captureFromDCWebcam();
    }
  });

  recaptureBtn.addEventListener('click', async ()=>{
    preview.style.display='none';
    $('#dc-placeholder').style.display='none';
    await initDCWebcam();
  });

  clearBtn.addEventListener('click', ()=>{
    fileInput.value='';
    dcImageDataUrl=null;
    preview.style.display='none';
    $('#dc-placeholder').style.display='';
    clearBtn.style.display='none';
    $('#dc-recapture').style.display='none';
    $('#dc-img-source').style.display='none';
    stopDCWebcam();
  });

  document.getElementById('dc-back').addEventListener('click', ()=> setActivePage('home-page'));

  document.getElementById('dc-send').addEventListener('click', async ()=>{
    const btn = document.getElementById('dc-send');
    btn.classList.add('loading'); btn.disabled = true;
    if(!dcImageDataUrl){ showToast('‡πÇ‡∏õ‡∏£‡∏î‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô', 'error'); btn.classList.remove('loading'); btn.disabled=false; return; }

    const overlay = ProgressOverlay.open({title:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û', text:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‚Ä¶'});

    const pr = $('#dc-progress'), fill = $('#dc-progress-fill'), txt = $('#dc-progress-text');
    pr.style.display = '';
    const sim = simulateProgress(fill, txt, (pct)=> overlay.update(pct, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶'));

    const compressed = await compressDataUrl(dcImageDataUrl, 1600, 0.75);

    const payload = {
      type: 'report',
      category: $('#dc-category').value,
      imageData: compressed || dcImageDataUrl,
      aiPrediction: '',
      aiConfidence: '',
      userCorrection: $('#dc-true').value.trim(),
      userDescription: $('#dc-note').value.trim()
    };

    const ok = await submitData(payload);
    sim.complete(!!ok);

    setTimeout(()=>{
      pr.style.display='none';
      btn.classList.remove('loading'); btn.disabled = false;
      overlay.update(100, ok ? '‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      setTimeout(()=> overlay.close(), 450);
      if(ok){
        modal.style.display='flex';
        modalOk.focus();
        $('#dc-true').value=''; $('#dc-note').value='';
        fileInput.value=''; dcImageDataUrl=null; preview.style.display='none';
        $('#dc-recapture').style.display='none'; $('#dc-clear').style.display='none'; $('#dc-img-source').style.display='none';
      }else{
        showToast('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
      }
    }, 350);
  });

  modalOk.addEventListener('click', ()=>{
    $('#dc-modal').style.display='none';
    setActivePage('home-page');
  });
}

/* Background/visibility */
document.addEventListener('visibilitychange', async ()=>{
  if(document.hidden){
    if(currentPageId==='analysis-page') stopWebcam();
    if(currentPageId==='direct-contrib-page') stopDCWebcam();
  }else{
    if(currentPageId==='analysis-page' && !hasLiveStream()){
      await initWebcam(); try{ await $('#webcam').play?.(); }catch(e){}
    }
  }
});
window.addEventListener('pagehide', ()=>{
  if(currentPageId==='analysis-page') stopWebcam();
  if(currentPageId==='direct-contrib-page') stopDCWebcam();
});
window.addEventListener('beforeunload', ()=>{
  if(currentPageId==='analysis-page') stopWebcam();
  if(currentPageId==='direct-contrib-page') stopDCWebcam();
});

/* ========== Global: Ripple handler (‡∏ó‡∏∏‡∏Å‡∏õ‡∏∏‡πà‡∏° .btn) ========== */
document.addEventListener('click', (e)=>{
  const btn = e.target.closest('.btn');
  if(!btn) return;
  const r = btn.getBoundingClientRect();
  btn.style.setProperty('--ripple-x', (e.clientX - r.left) + 'px');
  btn.style.setProperty('--ripple-y', (e.clientY - r.top) + 'px');
  btn.classList.remove('rippling'); // restart animation
  void btn.offsetWidth;
  btn.classList.add('rippling');
  setTimeout(()=> btn.classList.remove('rippling'), 650);
}, {passive:true});

/* INIT */
document.addEventListener('DOMContentLoaded', ()=>{
  updateNavVisibility('home-page');
  updateSteps('home-page');
  updateBackFab();

  bindNav();
  bindHomeCards();
  bindAnalysisButtons();
  bindResultButtons();
  bindDirectContribution();

  const logo = document.getElementById('logo');
  if(logo){
    logo.addEventListener('click',(e)=>{
      e.preventDefault();
      setActivePage('home-page');
      window.scrollTo({top:0,behavior:'smooth'});
    });
  }

  $$('#top-nav a').forEach(a=>{
    if(['result-page','report-feedback-page'].includes(a.dataset.target)) a.style.display='none';
  });

  window.addEventListener('resize', ()=> layoutStepsFill(currentStepIdx));

  window.requestIdleCallback?.(async ()=>{
    try{
      await ensureAILibs();
      prefetchModel(MODELS_INFO.insect.url);
      getModelByKey('insect');
    }catch(e){}
  }, {timeout: 2000});
});
</script>
</body>
</html>
